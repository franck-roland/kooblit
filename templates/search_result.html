{% extends "base.html" %}
{% load static %}
<!DOCTYPE html>

{% block extra_css %}
<link href="{% static "css/result_page.css" %}" rel="stylesheet">
{% endblock %}
{% block content %}
{% if resultat %}
<div class="container">
  {{ resultat|length }} résultats trouvés
</div>
{% endif %}
<div class="container container_result" style="padding-top:50px;">
<div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
  <!-- Indicators -->
<!--   <ol class="carousel-indicators">
    <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
    <li data-target="#carousel-example-generic" data-slide-to="1"></li>
    <li data-target="#carousel-example-generic" data-slide-to="2"></li>
  </ol> -->

  <!-- Wrapper for slides -->
  <div class="carousel-inner">
    <!-- <div class="item active">
      <div class="carousel-caption">
        ... 
        plp
      </div>
    </div> -->
  
  {% if resultat %}
    {% for item in resultat %}
      {% if forloop.counter0|divisibleby:4  %}
      <div class="item">
        <div class="col-xs-12 col-sm-12 col-md-12" style="text-align:center;">
          <span>
          {% if forloop.last %}
            {% widthratio resultat|length 4 1 %} / {% widthratio resultat|length 4 1 %}
          {% else %}
            {% widthratio forloop.counter0|add:4 4 1 %} / {% widthratio resultat|length 4 1 %}
          {% endif %}
          </span>
        </div>
      {% endif %}
        {% if item.image %}
          {% if forloop.counter0|divisibleby:4  %}
          <div class="img_container2 col-3 col-sm-3 col-lg-3 col-xs-6" style='padding:0;padding-left:2%;padding-right:2%;text-align:center;' >
          {% else %}
          <div class="img_container2 col-3 col-sm-3 col-lg-3 col-xs-6" style='padding:0;padding-left:2%;padding-right:2%;text-align:center;' >
          {% endif %}
         <!--    <a href="{{ item.2 }}"><img class="img-responsive img_res" src='{{ item.1 }}' alt='{{ item.0 }}' /></a> -->
        {% else %}
        <div class="img_container2 col-3 col-sm-3 col-lg-3 col-xs-6" style="background-image:url('{% static 'img/empty_gallery.png' %}');padding:0;">
            <!-- <a href="{{ item.2 }}"><img class="img-responsive img_res" src="{% static "img/empty_gallery.png" %}" alt='{{ item.0 }}' /></a> -->
        {% endif %}
          <div class="img_container2 col-10 col-sm-10 col-lg-10" style='padding:0;text-align:center;' >
            <div class="repre_image" style="text-align:center;margin:auto;background-image:url('{{ item.image }}');">
            <!-- <img src="{{ item.image }}" width="80%" height="80%"> -->
            <!-- <span>zpoekf</span> -->
            </div>
            <div class="col-xs-12 col-sm-12 col-md-12" style="text-align:center;background-color:white; padding:0;">
              <div class="result_title">
              {{item.little_title}}
              </div>
              {{item.author}}
              <div class="result_editorial_review">
              {{item.summary}}
              </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-12">
            <div class="col-xs-12 col-sm-12 col-md-4 col-md-offset-2" >
              <!-- <a id="search_button" class="thumbnail" href="/accounts/login/#enregistrement" style="height:80px;width:80px;margin:auto;">
                <img src="{% static "img/magnifier13.png" %}" width="30" style="height: 40px; width: 40px; display: block;text-align:center;margin-top:15px" />
              </a> -->
              <a class="search_button thumbnail" href="{% url 'book_management:search' item.title %}">
                <img src="{% static "img/magnifier13.png" %}"/>
              </a>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-4 col-md-offset-1" >
              <a class="gold_button thumbnail" href="{% url 'book_management:post' item.title '' %}">
                <img src="{% static "img/coins24.png" %}"/>
              </a>
            </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-12" style="height:100px;">
            </div>
          </div>
          <div class="img_container2 col-1 col-sm-1 col-lg-1" style='padding:0;text-align:center;' >
            <a class="thumbnail" href="{% url 'book_management:post' item.title '' %}">
                <img src="{% static "img/coins24.png" %}"/>
              </a>
          </div>
        </div>
      {% if forloop.counter0|add:"1"|divisibleby:"4"  or forloop.last %}
      </div>
      {% endif %}
    {% endfor %}
  {% else %}
    <img class="img-responsive img_res" src="{% static "img/empty_gallery.png" %}" alt='empty' />
  {% endif %}
    <!-- ... -->
  </div>

  <!-- Controls -->
  <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev" style="width:2%;">
    <span class="glyphicon glyphicon-chevron-left"></span>
  </a>
  <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next" style="width:2%;">
    <span class="glyphicon glyphicon-chevron-right"></span>
  </a>
</div>
</div>

{% endblock %}
{% block script_block %}
<script type="text/javascript" src="{% static "js/jquery.mobile.custom.min.js" %}"></script>
<script type="text/javascript">
  function isTouchSupported() {
    var msTouchEnabled = window.navigator.msMaxTouchPoints;
    var generalTouchEnabled = "ontouchstart" in document.createElement("div");
 
    if (msTouchEnabled || generalTouchEnabled) {
        return true;
    }
    return false;
  }
  $(".item:first").addClass("active");
  $(document).ready(function() {  
    $('.carousel').carousel({
      interval: false
    });
    if(isTouchSupported()){
       $("#carousel-example-generic").swiperight(function() {  
          $(this).carousel('prev');  
          });  
       $("#carousel-example-generic").swipeleft(function() {  
          $(this).carousel('next');
        $(".carousel-control").remove();  
     });
    }  
  }); 
  $(".gold_button").popover({trigger:'hover',placement:'bottom',content:"Je vends une synthèse"});
  $("#id_birthday").popover({trigger:'hover',placement:'right',content:"jj/mm/aaaa"});
</script>
{% endblock %}